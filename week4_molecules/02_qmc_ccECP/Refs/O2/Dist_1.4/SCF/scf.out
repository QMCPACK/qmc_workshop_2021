#INFO: **** input file is /home/abenali/Work/WorkShop/qmcpack_workshop_2021/qmc_workshop_2021/week4_molecules/03_qmc_ccECP/runs/O2/Dist_1.4/SCF/scf.py ****

#! /usr/bin/env python3

import numpy as np
from numpy import array

### generated pyscfimport text ###
from pyscf import df, scf, dft
### end generated pyscfimport text ###





### generated system text ###
from pyscf import gto as gto_loc
mol = gto_loc.Mole()
mol.verbose  = 5
mol.atom     = '''
               O    0.00000000   0.00000000   0.00000000
               O    0.00000000   0.00000000   1.40000000
               '''
mol.basis    = 'ccecp-ccpvtz'
mol.unit     = 'A'
mol.ecp      = 'ccecp'
mol.charge   = 0
mol.spin     = 2
mol.symmetry = False
mol.build()
### end generated system text ###




### generated calculation text ###
mf = scf.ROKS(mol).density_fit()
mf.max_cycle=200
mf.level_shift=0.0
mf.xc          = 'SCAN'
mf.tol         = '1e-10'
e_scf = mf.kernel()
### end generated calculation text ###



### generated conversion text ###
from PyscfToQmcpack import savetoqmcpack
savetoqmcpack(mol,mf,'scf')
### end generated conversion text ###

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='abenali', release='5.11.0-38-generic', version='#42~20.04.1-Ubuntu SMP Tue Sep 28 20:41:07 UTC 2021', machine='x86_64', processor='x86_64')  Threads 1
Python 3.7.11 (default, Sep  9 2021, 02:06:38) 
[GCC 9.3.0]
numpy 1.20.3  scipy 1.6.2
Date: Mon Oct 25 20:49:19 2021
PySCF version 2.0.0a
PySCF path  /home/abenali/Work/src/pyscf
GIT HEAD (branch master) 3e8ba375fd4229f000289589fd02193633380853

[CONFIG] conf_file None
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 2
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = A
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 O      0.000000000000   0.000000000000   1.400000000000 AA    0.000000000000   0.000000000000   2.645616574391 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] O
[INPUT] 0    0    [9    /1   ]  54.775216         -0.0012444
                                25.616801         0.010733
                                11.980245         0.0018889
                                6.992317          -0.1742537
                                2.620277          0.0017622
                                1.225429          0.3161846
                                0.577797          0.4512023
                                0.268022          0.3121534
                                0.125346          0.0511167
[INPUT] 0    0    [1    /1   ]  1.686633             1
[INPUT] 0    0    [1    /1   ]  0.237997             1
[INPUT] 1    0    [9    /1   ]  22.217266         0.0104866
                                10.74755          0.0366435
                                5.315785          0.0803674
                                2.660761          0.162701
                                1.331816          0.2377791
                                0.678626          0.2811422
                                0.333673          0.2643189
                                0.167017          0.1466014
                                0.083598          0.0458145
[INPUT] 1    0    [1    /1   ]  0.600621             1
[INPUT] 1    0    [1    /1   ]  0.184696             1
[INPUT] 2    0    [1    /1   ]  2.404278             1
[INPUT] 2    0    [1    /1   ]  0.66934              1
[INPUT] 3    0    [1    /1   ]  1.423104             1

nuclear repulsion = 13.6074139950857
number of shells = 18
number of NR pGTOs = 122
number of NR cGTOs = 58
basis = ccecp-ccpvtz
ecp = ccecp
CPU time:         0.26


******** <class 'pyscf.df.df_jk.density_fit.<locals>.DFHF'> ********
method = DFHF-ROKS-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0.0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/abenali/Work/WorkShop/qmcpack_workshop_2021/qmc_workshop_2021/week4_molecules/03_qmc_ccECP/runs/O2/Dist_1.4/SCF/tmpm865lmcg
max_memory 4000 MB (current use 108 MB)
num. doubly occ = 5  num. singly occ = 2
XC library pyscf.dft.libxc version 5.1.5
    S. Lehtola, C. Steigemann, M. J. Oliveira, and M. A. Marques, SoftwareX 7, 1 (2018)
XC functionals = SCAN
    J. Sun, A. Ruzsinszky, and J. P. Perdew, Phys. Rev. Lett. 115, 036402 (2015)
    J. Sun, A. Ruzsinszky, and J. P. Perdew, Phys. Rev. Lett. 115, 036402 (2015)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x7f5ce274cdd0>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x7f5ce2755290>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 3.16228e-05
atom O rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50
  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266
 266 266 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302
 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266
 266 266 266]
tot grids = 28524
Drop grids 2344
    CPU time for setting up grids      0.02 sec, wall time      0.02 sec
nelec by numeric integration = [6.00000023 6.00000023]
    CPU time for vxc      0.24 sec, wall time      0.24 sec
Even tempered Gaussians are generated as DF auxbasis for  O
  ETB auxbasis for O  [[0, [64.177152, 1]], [0, [32.088576, 1]], [0, [16.044288, 1]], [0, [8.022144, 1]], [0, [4.011072, 1]], [0, [2.005536, 1]], [0, [1.002768, 1]], [0, [0.501384, 1]], [0, [0.250692, 1]], [1, [52.41108427692326, 1]], [1, [26.20554213846163, 1]], [1, [13.102771069230815, 1]], [1, [6.551385534615408, 1]], [1, [3.275692767307704, 1]], [1, [1.637846383653852, 1]], [1, [0.818923191826926, 1]], [1, [0.409461595913463, 1]], [1, [0.2047307979567315, 1]], [2, [42.802176, 1]], [2, [21.401088, 1]], [2, [10.700544, 1]], [2, [5.350272, 1]], [2, [2.675136, 1]], [2, [1.337568, 1]], [2, [0.668784, 1]], [2, [0.334392, 1]], [2, [0.167196, 1]], [3, [7.569571782318998, 1]], [3, [3.784785891159499, 1]], [3, [1.8923929455797495, 1]], [3, [0.9461964727898747, 1]], [3, [0.47309823639493737, 1]], [4, [5.35472, 1]], [4, [2.67736, 1]], [4, [1.33868, 1]]]
num shells = 70, num cGTOs = 286
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -79.25754142408663  Ecoul = 40.39470615928662  Exc = -6.536543713162194
init E= -31.7919649828765
cond(S) = 527.24241209106
    CPU time for initialize scf      0.34 sec, wall time      0.36 sec
  HOMO = -0.292657607776347  LUMO = -0.0564072381030086
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.452156609954504 | -0.452156609954503 | -0.452156609954503
  Lowest 0-occ =  -0.0564072381030086 | -0.056407238103008 | -0.0564072381030081
  1-occ =         -0.292657607776349 | -0.292657607776348 | -0.292657607776348
  1-occ =         -0.292657607776347 | -0.292657607776347 | -0.292657607776347
  Roothaan mo_energy =
[-1.14349145 -0.873386   -0.50708322 -0.45215661 -0.45215661 -0.29265761
 -0.29265761 -0.05640724  0.38796425  0.43159369  0.43159369  0.4898601
  0.53316501  0.53316501  0.7621138   1.23799153  1.23799153  1.31461514
  1.31509421  1.3411782   1.59690706  1.59703338  1.84426214  2.05918241
  2.05918241  2.12817628  2.77501122  2.77501122  2.92671402  3.05969518
  3.05969518  4.07840683  4.69389891  4.69389891  4.81516236  4.81561003
  4.84209705  5.08223328  5.08223328  5.17589753  5.17589753  5.45641377
  5.45641622  6.03495615  6.03495615  6.32976382  6.32994424  6.4036147
  6.46847682  6.46847682  6.49985852  6.49990812  7.12784416  7.12784416
  7.23875419  7.47865427 15.27863539 17.38100199]
nelec by numeric integration = [7.00000024 5.00000021]
    CPU time for vxc      0.19 sec, wall time      0.19 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -79.6011347518762  Ecoul = 40.80758867303424  Exc = -6.717170195810416
cycle= 1 E= -31.9033022795667  delta_E= -0.111  |g|= 0.167  |ddm|= 1.83
    CPU time for cycle= 1      0.25 sec, wall time      0.25 sec
  HOMO = -0.250497444504368  LUMO = -0.0177621359959919
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.421006371471987 | -0.468102855672381 | -0.373909887271594
  Lowest 0-occ =  -0.0177621359959919 | -0.0391862322040839 | 0.00366196021209975
  1-occ =         -0.250497444504373 | -0.309639213643672 |  -0.19026808934813
  1-occ =         -0.250497444504368 |  -0.30963921364367 | -0.190268089348128
  Roothaan mo_energy =
[-1.13280953 -0.82023282 -0.46325945 -0.42100637 -0.42100637 -0.25049744
 -0.25049744 -0.01776214  0.42498112  0.45072574  0.45072574  0.51676435
  0.55706309  0.55706309  0.78770084  1.25164458  1.25164458  1.33640837
  1.33669714  1.36564494  1.6215023   1.62162089  1.86065889  2.08619711
  2.08619711  2.17069582  2.81364459  2.81364459  2.9619886   3.09820031
  3.09820031  4.12204052  4.70959666  4.70959666  4.83885559  4.83902831
  4.84337265  5.11056672  5.11056672  5.20469726  5.20469726  5.48132577
  5.48132789  6.05906201  6.05906201  6.37162436  6.37163461  6.44365379
  6.50136359  6.50136359  6.54496712  6.54506809  7.17223426  7.17223426
  7.27648311  7.52355394 15.33442166 17.43880925]
nelec by numeric integration = [7.00000024 5.00000021]
    CPU time for vxc      0.19 sec, wall time      0.19 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -79.50068542985365  Ecoul = 40.653444632277825  Exc = -6.6671485247792965
cycle= 2 E= -31.9069753272694  delta_E= -0.00367  |g|= 0.0767  |ddm|= 0.202
    CPU time for cycle= 2      0.24 sec, wall time      0.24 sec
  HOMO = -0.25967062866134  LUMO = -0.0233960700072404
                  Roothaan           | alpha              | beta
  Highest 2-occ =  -0.42649759555306 | -0.477177322711134 | -0.380888501643659
  Lowest 0-occ =  -0.0233960700072404 | -0.0476053915181801 | -0.00426858010637019
  1-occ =         -0.259670628661342 | -0.324449579741262 | -0.202889491180554
  1-occ =          -0.25967062866134 | -0.324449579741262 | -0.202889491180553
  Roothaan mo_energy =
[-1.13201621 -0.83307441 -0.47619859 -0.4264976  -0.4264976  -0.25967063
 -0.25967063 -0.02339607  0.41697151  0.44797366  0.44797366  0.51208201
  0.55321121  0.55321121  0.78349387  1.24982509  1.24982509  1.33478863
  1.33508915  1.36134367  1.61749068  1.6176225   1.85503105  2.0791314
  2.0791314   2.16036561  2.80407402  2.80407402  2.95370059  3.08976176
  3.08976176  4.11449987  4.70599966  4.70599966  4.83370601  4.83387947
  4.84224867  5.10576592  5.10576592  5.19968479  5.19968479  5.47752855
  5.47755159  6.05683819  6.05683819  6.36159473  6.36191602  6.43925896
  6.49092212  6.49092212  6.53316579  6.53340886  7.15903503  7.15903503
  7.2662283   7.51190597 15.31800181 17.42375897]
nelec by numeric integration = [7.00000024 5.00000021]
    CPU time for vxc      0.19 sec, wall time      0.19 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -79.55114103011641  Ecoul = 40.72444747339866  Exc = -6.688817024543634
cycle= 3 E= -31.9080965861757  delta_E= -0.00112  |g|= 0.00711  |ddm|= 0.0717
    CPU time for cycle= 3      0.24 sec, wall time      0.24 sec
  HOMO = -0.257767676972598  LUMO = -0.0216388163630682
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.425345931874855 | -0.473187748066036 | -0.376967775728182
  Lowest 0-occ =  -0.0216388163630682 | -0.0429665814980509 | 0.000316445844984693
  1-occ =         -0.257767676972599 | -0.318208236761082 | -0.196438273865944
  1-occ =         -0.257767676972598 | -0.318208236761081 | -0.196438273865944
  Roothaan mo_energy =
[-1.13106227 -0.83122517 -0.47417614 -0.42534593 -0.42534593 -0.25776768
 -0.25776768 -0.02163882  0.41830427  0.44846023  0.44846023  0.51292783
  0.55370916  0.55370916  0.78435063  1.25054135  1.25054135  1.33547529
  1.33575806  1.3623702   1.61839793  1.61852746  1.85592849  2.08049555
  2.08049555  2.16203466  2.80560575  2.80560575  2.95572273  3.09134071
  3.09134071  4.11653089  4.70744918  4.70744918  4.83497411  4.83511998
  4.84276091  5.10696501  5.10696501  5.20093932  5.20093932  5.47889848
  5.47890624  6.05834555  6.05834555  6.36350536  6.36385923  6.44113934
  6.49299119  6.49299119  6.53527027  6.53553871  7.16140858  7.16140858
  7.26851628  7.51394119 15.32063992 17.42660909]
nelec by numeric integration = [7.00000024 5.00000021]
    CPU time for vxc      0.19 sec, wall time      0.19 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -79.54113916944556  Ecoul = 40.7114210957048  Exc = -6.68580160452553
cycle= 4 E= -31.9081056831806  delta_E= -9.1e-06  |g|= 0.00133  |ddm|= 0.0079
    CPU time for cycle= 4      0.24 sec, wall time      0.24 sec
  HOMO = -0.258209107190105  LUMO = -0.0221074166566502
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.425766207692599 | -0.474076625125413 |  -0.37780980134047
  Lowest 0-occ =  -0.0221074166566502 | -0.0439483927142903 | -0.000664940204124873
  1-occ =         -0.258209107190106 | -0.319295495474748 |  -0.19747040382117
  1-occ =         -0.258209107190105 | -0.319295495474749 | -0.197470403821171
  Roothaan mo_energy =
[-1.13154115 -0.83166833 -0.47462978 -0.42576621 -0.42576621 -0.25820911
 -0.25820911 -0.02210742  0.41809745  0.44822677  0.44822677  0.51273585
  0.55351995  0.55351995  0.78404872  1.25021306  1.25021306  1.33520627
  1.33548864  1.3620922   1.61813221  1.61826177  1.8555672   2.08021804
  2.08021804  2.16173611  2.80514761  2.80514761  2.95522783  3.09089287
  3.09089287  4.11614306  4.70708453  4.70708453  4.83461228  4.83475706
  4.84230756  5.1066228   5.1066228   5.20060008  5.20060008  5.47854062
  5.47854999  6.0578947   6.0578947   6.36298767  6.36334503  6.44061193
  6.49246136  6.49246136  6.5347667   6.53503892  7.16097822  7.16097822
  7.26799579  7.51353491 15.31997913 17.42591866]
nelec by numeric integration = [7.00000024 5.00000021]
    CPU time for vxc      0.19 sec, wall time      0.19 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -79.54493767136744  Ecoul = 40.716112623398885  Exc = -6.686694964382929
cycle= 5 E= -31.9081060172658  delta_E= -3.34e-07  |g|= 0.000398  |ddm|= 0.002
    CPU time for cycle= 5      0.24 sec, wall time      0.24 sec
  HOMO = -0.258096574725236  LUMO = -0.0219971294752047
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.425675852601765 | -0.473732822176342 | -0.377463316890337
  Lowest 0-occ =  -0.0219971294752047 | -0.0435526614847917 | -0.000264044171655295
  1-occ =         -0.258096574725236 | -0.318928904520656 |   -0.1970987594449
  1-occ =         -0.258096574725236 | -0.318928904520657 | -0.197098759444901
  Roothaan mo_energy =
[-1.1314362  -0.83157354 -0.47453324 -0.42567585 -0.42567585 -0.25809657
 -0.25809657 -0.02199713  0.41813815  0.44826839  0.44826839  0.51276536
  0.55354869  0.55354869  0.78411225  1.25027371  1.25027371  1.33526575
  1.33554778  1.3621563   1.61819302  1.61832242  1.85563126  2.08027999
  2.08027999  2.16180732  2.80524476  2.80524476  2.95534745  3.09099083
  3.09099083  4.11624917  4.70716912  4.70716912  4.83469223  4.83483654
  4.84238326  5.1067022   5.1067022   5.20068043  5.20068043  5.47862921
  5.47863927  6.05800573  6.05800573  6.36311018  6.36346967  6.44073234
  6.492586    6.492586    6.534887    6.53516089  7.16108732  7.16108732
  7.26811236  7.51363392 15.32014266 17.42609999]
nelec by numeric integration = [7.00000024 5.00000021]
    CPU time for vxc      0.19 sec, wall time      0.19 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -79.54407165966599  Ecoul = 40.715046634892325  Exc = -6.686495018480306
cycle= 6 E= -31.9081060481683  delta_E= -3.09e-08  |g|= 3.74e-06  |ddm|= 0.000418
    CPU time for cycle= 6      0.24 sec, wall time      0.24 sec
  HOMO = -0.258097442018659  LUMO = -0.0219977448993801
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.425676900132064 | -0.473811855028982 | -0.377542436729741
  Lowest 0-occ =  -0.0219977448993801 | -0.0436421738817601 | -0.000353908081147792
  1-occ =         -0.258097442018662 | -0.319013204443074 | -0.197182234363876
  1-occ =         -0.258097442018659 | -0.319013204443074 | -0.197182234363876
  Roothaan mo_energy =
[-1.13143693 -0.83157451 -0.4745339  -0.4256769  -0.4256769  -0.25809744
 -0.25809744 -0.02199774  0.41813777  0.44826757  0.44826757  0.51276471
  0.55354781  0.55354781  0.78411185  1.2502726   1.2502726   1.33526532
  1.33554734  1.36215598  1.61819265  1.61832205  1.85563076  2.08027951
  2.08027951  2.16180747  2.80524347  2.80524347  2.95534689  3.09098976
  3.09098976  4.11624914  4.7071687   4.7071687   4.83469155  4.83483587
  4.8423824   5.1067017   5.1067017   5.20068003  5.20068003  5.47862915
  5.47863927  6.05800513  6.05800513  6.36310923  6.36346877  6.44073119
  6.49258506  6.49258506  6.53488606  6.53516001  7.16108696  7.16108696
  7.26811122  7.51363348 15.32014154 17.42609912]
nelec by numeric integration = [7.00000024 5.00000021]
    CPU time for vxc      0.19 sec, wall time      0.19 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -79.54407817416903  Ecoul = 40.71505488680657  Exc = -6.686496755894652
cycle= 7 E= -31.9081060481714  delta_E= -3.14e-12  |g|= 7.59e-07  |ddm|= 6.56e-06
    CPU time for cycle= 7      0.24 sec, wall time      0.24 sec
  HOMO = -0.258097046996501  LUMO = -0.0219973512103108
                  Roothaan           | alpha              | beta
  Highest 2-occ =  -0.42567656499894 | -0.473811288006177 | -0.377541841991707
  Lowest 0-occ =  -0.0219973512103108 | -0.0436415149673112 | -0.000353187453309414
  1-occ =         -0.258097046996502 | -0.319012564669455 | -0.197181541309525
  1-occ =         -0.258097046996501 | -0.319012564669454 | -0.197181541309524
  Roothaan mo_energy =
[-1.13143656 -0.83157414 -0.47453353 -0.42567656 -0.42567656 -0.25809705
 -0.25809705 -0.02199735  0.41813796  0.44826776  0.44826776  0.51276487
  0.55354797  0.55354797  0.78411211  1.25027283  1.25027283  1.33526555
  1.33554757  1.36215623  1.61819289  1.61832229  1.85563104  2.08027976
  2.08027976  2.16180776  2.80524383  2.80524383  2.95534731  3.09099014
  3.09099014  4.11624952  4.70716901  4.70716901  4.83469184  4.83483616
  4.84238272  5.106702    5.106702    5.20068033  5.20068033  5.47862947
  5.4786396   6.0580055   6.0580055   6.36310967  6.36346922  6.44073163
  6.4925855   6.4925855   6.53488649  6.53516046  7.16108737  7.16108737
  7.26811165  7.51363385 15.3201421  17.42609972]
nelec by numeric integration = [7.00000024 5.00000021]
    CPU time for vxc      0.19 sec, wall time      0.19 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -79.54407529204052  Ecoul = 40.71505131489203  Exc = -6.686496066108621
Extra cycle  E= -31.9081060481714  delta_E=    0  |g|= 5.95e-07  |ddm|= 1.48e-06
    CPU time for scf_cycle      2.29 sec, wall time      2.31 sec
    CPU time for SCF      2.29 sec, wall time      2.31 sec
converged SCF energy = -31.9081060481714
Using Python 3.x
Wavefunction successfully saved to QMCPACK HDF5 Format
Use: "convert4qmc -pyscf  scf.h5" to generate QMCPACK input files
