#INFO: **** input file is /home/abenali/Work/WorkShop/qmcpack_workshop_2021/qmc_workshop_2021/week4_molecules/03_qmc_ccECP/runs/O2/Dist_1.6/SCF/scf.py ****

#! /usr/bin/env python3

import numpy as np
from numpy import array

### generated pyscfimport text ###
from pyscf import df, scf, dft
### end generated pyscfimport text ###





### generated system text ###
from pyscf import gto as gto_loc
mol = gto_loc.Mole()
mol.verbose  = 5
mol.atom     = '''
               O    0.00000000   0.00000000   0.00000000
               O    0.00000000   0.00000000   1.60000000
               '''
mol.basis    = 'ccecp-ccpvtz'
mol.unit     = 'A'
mol.ecp      = 'ccecp'
mol.charge   = 0
mol.spin     = 2
mol.symmetry = False
mol.build()
### end generated system text ###




### generated calculation text ###
mf = scf.ROKS(mol).density_fit()
mf.max_cycle=200
mf.level_shift=0.0
mf.xc          = 'SCAN'
mf.tol         = '1e-10'
e_scf = mf.kernel()
### end generated calculation text ###



### generated conversion text ###
from PyscfToQmcpack import savetoqmcpack
savetoqmcpack(mol,mf,'scf')
### end generated conversion text ###

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='abenali', release='5.11.0-38-generic', version='#42~20.04.1-Ubuntu SMP Tue Sep 28 20:41:07 UTC 2021', machine='x86_64', processor='x86_64')  Threads 1
Python 3.7.11 (default, Sep  9 2021, 02:06:38) 
[GCC 9.3.0]
numpy 1.20.3  scipy 1.6.2
Date: Mon Oct 25 22:51:16 2021
PySCF version 2.0.0a
PySCF path  /home/abenali/Work/src/pyscf
GIT HEAD (branch master) 3e8ba375fd4229f000289589fd02193633380853

[CONFIG] conf_file None
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 2
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = A
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 O      0.000000000000   0.000000000000   1.600000000000 AA    0.000000000000   0.000000000000   3.023561799304 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] O
[INPUT] 0    0    [9    /1   ]  54.775216         -0.0012444
                                25.616801         0.010733
                                11.980245         0.0018889
                                6.992317          -0.1742537
                                2.620277          0.0017622
                                1.225429          0.3161846
                                0.577797          0.4512023
                                0.268022          0.3121534
                                0.125346          0.0511167
[INPUT] 0    0    [1    /1   ]  1.686633             1
[INPUT] 0    0    [1    /1   ]  0.237997             1
[INPUT] 1    0    [9    /1   ]  22.217266         0.0104866
                                10.74755          0.0366435
                                5.315785          0.0803674
                                2.660761          0.162701
                                1.331816          0.2377791
                                0.678626          0.2811422
                                0.333673          0.2643189
                                0.167017          0.1466014
                                0.083598          0.0458145
[INPUT] 1    0    [1    /1   ]  0.600621             1
[INPUT] 1    0    [1    /1   ]  0.184696             1
[INPUT] 2    0    [1    /1   ]  2.404278             1
[INPUT] 2    0    [1    /1   ]  0.66934              1
[INPUT] 3    0    [1    /1   ]  1.423104             1

nuclear repulsion = 11.9064872457
number of shells = 18
number of NR pGTOs = 122
number of NR cGTOs = 58
basis = ccecp-ccpvtz
ecp = ccecp
CPU time:         0.26


******** <class 'pyscf.df.df_jk.density_fit.<locals>.DFHF'> ********
method = DFHF-ROKS-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0.0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/abenali/Work/WorkShop/qmcpack_workshop_2021/qmc_workshop_2021/week4_molecules/03_qmc_ccECP/runs/O2/Dist_1.6/SCF/tmpjxse4s5s
max_memory 4000 MB (current use 108 MB)
num. doubly occ = 5  num. singly occ = 2
XC library pyscf.dft.libxc version 5.1.5
    S. Lehtola, C. Steigemann, M. J. Oliveira, and M. A. Marques, SoftwareX 7, 1 (2018)
XC functionals = SCAN
    J. Sun, A. Ruzsinszky, and J. P. Perdew, Phys. Rev. Lett. 115, 036402 (2015)
    J. Sun, A. Ruzsinszky, and J. P. Perdew, Phys. Rev. Lett. 115, 036402 (2015)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x7fbd5eb01dd0>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x7fbd5eb0a290>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 3.16228e-05
atom O rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50
  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266
 266 266 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302
 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266
 266 266 266]
tot grids = 28524
Drop grids 2284
    CPU time for setting up grids      0.02 sec, wall time      0.02 sec
nelec by numeric integration = [6.00000011 6.00000011]
    CPU time for vxc      0.25 sec, wall time      0.25 sec
Even tempered Gaussians are generated as DF auxbasis for  O
  ETB auxbasis for O  [[0, [64.177152, 1]], [0, [32.088576, 1]], [0, [16.044288, 1]], [0, [8.022144, 1]], [0, [4.011072, 1]], [0, [2.005536, 1]], [0, [1.002768, 1]], [0, [0.501384, 1]], [0, [0.250692, 1]], [1, [52.41108427692326, 1]], [1, [26.20554213846163, 1]], [1, [13.102771069230815, 1]], [1, [6.551385534615408, 1]], [1, [3.275692767307704, 1]], [1, [1.637846383653852, 1]], [1, [0.818923191826926, 1]], [1, [0.409461595913463, 1]], [1, [0.2047307979567315, 1]], [2, [42.802176, 1]], [2, [21.401088, 1]], [2, [10.700544, 1]], [2, [5.350272, 1]], [2, [2.675136, 1]], [2, [1.337568, 1]], [2, [0.668784, 1]], [2, [0.334392, 1]], [2, [0.167196, 1]], [3, [7.569571782318998, 1]], [3, [3.784785891159499, 1]], [3, [1.8923929455797495, 1]], [3, [0.9461964727898747, 1]], [3, [0.47309823639493737, 1]], [4, [5.35472, 1]], [4, [2.67736, 1]], [4, [1.33868, 1]]]
num shells = 70, num cGTOs = 286
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -76.00066993083698  Ecoul = 38.88808184212473  Exc = -6.470530764837418
init E= -31.6766316078497
cond(S) = 288.93016160432995
    CPU time for initialize scf      0.35 sec, wall time      0.37 sec
  HOMO = -0.315208522187179  LUMO = -0.16731940821817
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.413602622466319 | -0.413602622466318 | -0.413602622466318
  Lowest 0-occ =   -0.16731940821817 | -0.167319408218168 | -0.167319408218168
  1-occ =         -0.315208522187179 | -0.315208522187176 | -0.315208522187176
  1-occ =         -0.315208522187179 | -0.315208522187178 | -0.315208522187178
  Roothaan mo_energy =
[-1.06587117 -0.90293471 -0.47175763 -0.41360262 -0.41360262 -0.31520852
 -0.31520852 -0.16731941  0.3977046   0.43157266  0.43157266  0.51357468
  0.53138433  0.53138433  0.78085434  1.22604404  1.22604404  1.25537781
  1.37426949  1.37436662  1.5461576   1.54625062  1.57112901  1.91566637
  1.91566637  2.18830635  2.79328354  2.79328354  2.80945519  2.99740012
  2.99740012  3.70450518  4.80822853  4.80822853  4.85246542  4.99998196
  5.00031493  5.12580138  5.12580138  5.15245947  5.15245947  5.26318212
  5.26326068  5.59948215  5.59948215  5.93562957  6.3415615   6.34168371
  6.3542712   6.3542712   6.46095952  6.46105044  6.78977294  6.89396757
  6.89396757  7.71564898 15.14396589 16.5951665 ]
nelec by numeric integration = [7.00000006 5.00000014]
    CPU time for vxc      0.19 sec, wall time      0.19 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -76.26354474820984  Ecoul = 39.120901742260045  Exc = -6.6063683404707065
cycle= 1 E= -31.8425241007205  delta_E= -0.166  |g|= 0.115  |ddm|= 1.74
    CPU time for cycle= 1      0.25 sec, wall time      0.25 sec
  HOMO = -0.289634533228255  LUMO = -0.148797762083431
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.393415243574736 |  -0.44130658006426 | -0.345523907085218
  Lowest 0-occ =  -0.148797762083431 | -0.164491155857751 |   -0.1331043683091
  1-occ =         -0.289634533228256 |  -0.34577804480481 | -0.232092751657598
  1-occ =         -0.289634533228255 |  -0.34577804480481 | -0.232092751657598
  Roothaan mo_energy =
[-1.0539369  -0.87243514 -0.44768394 -0.39341524 -0.39341524 -0.28963453
 -0.28963453 -0.14879776  0.42031445  0.44476699  0.44476699  0.52993167
  0.54771095  0.54771095  0.79273018  1.22918351  1.22918351  1.27110028
  1.38909445  1.38924345  1.56328189  1.56342677  1.57506551  1.92469025
  1.92469025  2.21063318  2.81657725  2.81657725  2.834734    3.02092056
  3.02092056  3.72059162  4.81096687  4.81096687  4.85081882  5.01002591
  5.01006639  5.14329563  5.14329563  5.16987279  5.16987279  5.26975694
  5.2699507   5.59137649  5.59137649  5.93694066  6.36607551  6.36672601
  6.3672071   6.3672071   6.48747626  6.48796205  6.81138664  6.91051971
  6.91051971  7.71335374 15.17606006 16.62851915]
nelec by numeric integration = [7.00000005 5.00000014]
    CPU time for vxc      0.19 sec, wall time      0.19 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -76.24360793217748  Ecoul = 39.07402706288189  Exc = -6.581599836582471
cycle= 2 E= -31.8446934601781  delta_E= -0.00217  |g|= 0.0576  |ddm|= 0.159
    CPU time for cycle= 2      0.24 sec, wall time      0.24 sec
  HOMO = -0.292309348948583  LUMO = -0.149405842187074
                  Roothaan           | alpha              | beta
  Highest 2-occ =  -0.39451449053929 | -0.443818766762776 | -0.346471211083244
  Lowest 0-occ =  -0.149405842187074 |  -0.16564655860754 | -0.133766540837682
  1-occ =         -0.292309348948586 | -0.351463292757818 | -0.235981488708131
  1-occ =         -0.292309348948583 | -0.351463292757817 | -0.235981488708129
  Roothaan mo_energy =
[-1.0511019  -0.8770742  -0.45170341 -0.39451449 -0.39451449 -0.29230935
 -0.29230935 -0.14940584  0.41590234  0.44432845  0.44432845  0.52789183
  0.54609744  0.54609744  0.79301395  1.23098401  1.23098401  1.2709384
  1.38970097  1.38985145  1.56286198  1.56301492  1.57705148  1.92264346
  1.92264346  2.2046873   2.81330414  2.81330414  2.83202669  3.01800475
  3.01800475  3.7193959   4.80949944  4.80949944  4.85172249  5.00897848
  5.0089961   5.14256684  5.14256684  5.16911062  5.16911062  5.26967496
  5.26983755  5.59297727  5.59297727  5.93896239  6.36300125  6.36371585
  6.36456705  6.36456705  6.48349969  6.48404841  6.80890195  6.90493701
  6.90493701  7.70838534 15.16992209 16.62223391]
nelec by numeric integration = [7.00000006 5.00000014]
    CPU time for vxc      0.19 sec, wall time      0.19 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -76.24934795796855  Ecoul = 39.08847167113812  Exc = -6.5909948650768175
cycle= 3 E= -31.8453839062072  delta_E= -0.00069  |g|= 0.00374  |ddm|= 0.044
    CPU time for cycle= 3      0.24 sec, wall time      0.24 sec
  HOMO = -0.292157591825612  LUMO = -0.1493159338667
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.394811382413826 | -0.443528353451399 | -0.346061331868284
  Lowest 0-occ =    -0.1493159338667 | -0.165346693147967 | -0.133238237993735
  1-occ =         -0.292157591825614 | -0.349894709333488 | -0.234169653394653
  1-occ =         -0.292157591825612 | -0.349894709333486 | -0.234169653394652
  Roothaan mo_energy =
[-1.05156514 -0.87708015 -0.451616   -0.39481138 -0.39481138 -0.29215759
 -0.29215759 -0.14931593  0.41640191  0.44399034  0.44399034  0.52805491
  0.54586031  0.54586031  0.79274814  1.23072804  1.23072804  1.27087181
  1.38952943  1.38967075  1.56275878  1.56289973  1.57660801  1.92271671
  1.92271671  2.20513174  2.81316473  2.81316473  2.83228969  3.0178106
  3.0178106   3.71976759  4.80965963  4.80965963  4.85149263  5.00897595
  5.00898077  5.14257911  5.14257911  5.16912964  5.16912964  5.26966344
  5.26983019  5.59310843  5.59310843  5.93914515  6.36298654  6.36371979
  6.36458977  6.36458977  6.48355995  6.48412568  6.80920649  6.90522997
  6.90522997  7.70923233 15.16999214 16.62238151]
nelec by numeric integration = [7.00000006 5.00000014]
    CPU time for vxc      0.19 sec, wall time      0.19 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -76.25169381304734  Ecoul = 39.091014803952795  Exc = -6.591195277535952
cycle= 4 E= -31.8453870409305  delta_E= -3.13e-06  |g|= 0.000655  |ddm|= 0.00448
    CPU time for cycle= 4      0.24 sec, wall time      0.24 sec
  HOMO = -0.291868948504067  LUMO = -0.149015506263976
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.394587541232604 | -0.443313147539436 | -0.345825572968799
  Lowest 0-occ =  -0.149015506263976 | -0.165058742745278 | -0.132934185094051
  1-occ =         -0.291868948504068 |  -0.34973537263754 | -0.233973670458433
  1-occ =         -0.291868948504067 | -0.349735372637539 | -0.233973670458432
  Roothaan mo_energy =
[-1.05132363 -0.8768278  -0.45136931 -0.39458754 -0.39458754 -0.29186895
 -0.29186895 -0.14901551  0.41650983  0.44409734  0.44409734  0.5281479
  0.54593606  0.54593606  0.79290996  1.23087686  1.23087686  1.27103439
  1.38967842  1.38981869  1.5629108   1.56305021  1.57675895  1.92288019
  1.92288019  2.20532662  2.81341505  2.81341505  2.83257991  3.01805515
  3.01805515  3.720081    4.80987444  4.80987444  4.85168218  5.00918165
  5.00918588  5.14278161  5.14278161  5.16933262  5.16933262  5.26987821
  5.27004588  5.59337745  5.59337745  5.93946796  6.3633029   6.36403516
  6.36491564  6.36491564  6.48387394  6.48443872  6.80951644  6.90554177
  6.90554177  7.70957837 15.17041331 16.62282263]
nelec by numeric integration = [7.00000006 5.00000014]
    CPU time for vxc      0.19 sec, wall time      0.19 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -76.24952643873866  Ecoul = 39.088305324976254  Exc = -6.590653219577012
cycle= 5 E= -31.8453870876394  delta_E= -4.67e-08  |g|= 0.000425  |ddm|= 0.00113
    CPU time for cycle= 5      0.24 sec, wall time      0.24 sec
  HOMO = -0.291975379329302  LUMO = -0.149124696368187
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.394683510079186 | -0.443515887152697 | -0.346020023973095
  Lowest 0-occ =  -0.149124696368187 | -0.165287825152954 | -0.133159420329435
  1-occ =         -0.291975379329304 |  -0.34995312581603 | -0.234183760710003
  1-occ =         -0.291975379329302 |  -0.34995312581603 | -0.234183760710002
  Roothaan mo_energy =
[-1.05142885 -0.87693211 -0.45147399 -0.39468351 -0.39468351 -0.29197538
 -0.29197538 -0.1491247   0.41646461  0.44404292  0.44404292  0.52810214
  0.54589372  0.54589372  0.79284035  1.2308097   1.2308097   1.27096913
  1.38961783  1.38975822  1.56284847  1.56298777  1.57667123  1.92281399
  1.92281399  2.20525515  2.81330799  2.81330799  2.83246798  3.01794772
  3.01794772  3.71998285  4.80979134  4.80979134  4.85159375  5.00909927
  5.00910337  5.14270039  5.14270039  5.16925139  5.16925139  5.26979611
  5.26996407  5.59329132  5.59329132  5.93936811  6.36317932  6.36391175
  6.36479125  6.36479125  6.48375106  6.48431608  6.80939128  6.90542653
  6.90542653  7.70947935 15.17025299 16.62266124]
nelec by numeric integration = [7.00000006 5.00000014]
    CPU time for vxc      0.19 sec, wall time      0.19 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -76.25039621628346  Ecoul = 39.08939542232367  Exc = -6.59087357588428
cycle= 6 E= -31.8453871241441  delta_E= -3.65e-08  |g|= 1.34e-05  |ddm|= 0.00047
    CPU time for cycle= 6      0.24 sec, wall time      0.24 sec
  HOMO = -0.291978858238624  LUMO = -0.149126788360958
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.394685900204985 | -0.443436675092067 | -0.345940119605023
  Lowest 0-occ =  -0.149126788360958 | -0.165194475122405 | -0.133065055421746
  1-occ =         -0.291978858238626 | -0.349866649275403 | -0.234096385330053
  1-occ =         -0.291978858238624 | -0.349866649275402 | -0.234096385330052
  Roothaan mo_energy =
[-1.05143189 -0.8769343  -0.45147631 -0.3946859  -0.3946859  -0.29197886
 -0.29197886 -0.14912679  0.41646407  0.44404183  0.44404183  0.52810155
  0.54589321  0.54589321  0.79283887  1.23080872  1.23080872  1.27096752
  1.38961642  1.38975685  1.5628469   1.56298619  1.5766686   1.9228131
  1.9228131   2.20525464  2.81330521  2.81330521  2.83246527  3.01794508
  3.01794508  3.71998153  4.80979005  4.80979005  4.85159207  5.00909759
  5.00910168  5.14269788  5.14269788  5.16924888  5.16924888  5.26979447
  5.2699625   5.59329098  5.59329098  5.93936811  6.3631758   6.36390818
  6.36478846  6.36478846  6.48374758  6.48431256  6.80938828  6.90542448
  6.90542448  7.70948024 15.17024841 16.62265665]
nelec by numeric integration = [7.00000006 5.00000014]
    CPU time for vxc      0.19 sec, wall time      0.19 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -76.2504220024627  Ecoul = 39.08942727154641  Exc = -6.590879638962795
cycle= 7 E= -31.8453871241791  delta_E= -3.5e-11  |g|= 3.91e-07  |ddm|= 1.34e-05
    CPU time for cycle= 7      0.24 sec, wall time      0.24 sec
  HOMO = -0.291979011321182  LUMO = -0.149126939033514
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.394686023594176 |  -0.44343427240779 | -0.345937774780564
  Lowest 0-occ =  -0.149126939033514 | -0.165191690480568 | -0.133062187586454
  1-occ =         -0.291979011321186 | -0.349864107191248 |  -0.23409391350788
  1-occ =         -0.291979011321182 | -0.349864107191246 | -0.234093913507878
  Roothaan mo_energy =
[-1.05143206 -0.87693442 -0.45147646 -0.39468602 -0.39468602 -0.29197901
 -0.29197901 -0.14912694  0.41646405  0.44404177  0.44404177  0.52810151
  0.54589318  0.54589318  0.79283876  1.23080865  1.23080865  1.27096743
  1.38961633  1.38975676  1.56284682  1.5629861   1.57666845  1.92281303
  1.92281303  2.2052546   2.81330508  2.81330508  2.83246515  3.01794497
  3.01794497  3.71998141  4.80978996  4.80978996  4.85159194  5.00909748
  5.00910157  5.14269776  5.14269776  5.16924875  5.16924875  5.26979434
  5.26996238  5.59329088  5.59329088  5.93936805  6.36317562  6.36390801
  6.36478829  6.36478829  6.48374742  6.4843124   6.80938815  6.90542435
  6.90542435  7.70948021 15.17024819 16.62265643]
nelec by numeric integration = [7.00000006 5.00000014]
    CPU time for vxc      0.19 sec, wall time      0.19 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -76.25042320867566  Ecoul = 39.08942873725549  Exc = -6.590879898458901
Extra cycle  E= -31.8453871241791  delta_E= 1.42e-14  |g|= 3.83e-07  |ddm|= 5.95e-07
    CPU time for scf_cycle      2.30 sec, wall time      2.32 sec
    CPU time for SCF      2.30 sec, wall time      2.32 sec
converged SCF energy = -31.8453871241791
Using Python 3.x
Wavefunction successfully saved to QMCPACK HDF5 Format
Use: "convert4qmc -pyscf  scf.h5" to generate QMCPACK input files
