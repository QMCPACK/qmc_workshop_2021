#INFO: **** input file is /home/abenali/Work/WorkShop/qmcpack_workshop_2021/qmc_workshop_2021/week4_molecules/03_qmc_ccECP/runs/O2/Dist_1/SCF/scf.py ****

#! /usr/bin/env python3

import numpy as np
from numpy import array

### generated pyscfimport text ###
from pyscf import df, scf, dft
### end generated pyscfimport text ###





### generated system text ###
from pyscf import gto as gto_loc
mol = gto_loc.Mole()
mol.verbose  = 5
mol.atom     = '''
               O    0.00000000   0.00000000   0.00000000
               O    0.00000000   0.00000000   1.00000000
               '''
mol.basis    = 'ccecp-ccpvtz'
mol.unit     = 'A'
mol.ecp      = 'ccecp'
mol.charge   = 0
mol.spin     = 2
mol.symmetry = False
mol.build()
### end generated system text ###




### generated calculation text ###
mf = scf.ROKS(mol).density_fit()
mf.max_cycle=200
mf.level_shift=0.0
mf.xc          = 'SCAN'
mf.tol         = '1e-10'
e_scf = mf.kernel()
### end generated calculation text ###



### generated conversion text ###
from PyscfToQmcpack import savetoqmcpack
savetoqmcpack(mol,mf,'scf')
### end generated conversion text ###

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='abenali', release='5.11.0-38-generic', version='#42~20.04.1-Ubuntu SMP Tue Sep 28 20:41:07 UTC 2021', machine='x86_64', processor='x86_64')  Threads 1
Python 3.7.11 (default, Sep  9 2021, 02:06:38) 
[GCC 9.3.0]
numpy 1.20.3  scipy 1.6.2
Date: Mon Oct 25 21:21:03 2021
PySCF version 2.0.0a
PySCF path  /home/abenali/Work/src/pyscf
GIT HEAD (branch master) 3e8ba375fd4229f000289589fd02193633380853

[CONFIG] conf_file None
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 12
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 2
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = A
[INPUT]  1 O      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 O      0.000000000000   0.000000000000   1.000000000000 AA    0.000000000000   0.000000000000   1.889726124565 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] O
[INPUT] 0    0    [9    /1   ]  54.775216         -0.0012444
                                25.616801         0.010733
                                11.980245         0.0018889
                                6.992317          -0.1742537
                                2.620277          0.0017622
                                1.225429          0.3161846
                                0.577797          0.4512023
                                0.268022          0.3121534
                                0.125346          0.0511167
[INPUT] 0    0    [1    /1   ]  1.686633             1
[INPUT] 0    0    [1    /1   ]  0.237997             1
[INPUT] 1    0    [9    /1   ]  22.217266         0.0104866
                                10.74755          0.0366435
                                5.315785          0.0803674
                                2.660761          0.162701
                                1.331816          0.2377791
                                0.678626          0.2811422
                                0.333673          0.2643189
                                0.167017          0.1466014
                                0.083598          0.0458145
[INPUT] 1    0    [1    /1   ]  0.600621             1
[INPUT] 1    0    [1    /1   ]  0.184696             1
[INPUT] 2    0    [1    /1   ]  2.404278             1
[INPUT] 2    0    [1    /1   ]  0.66934              1
[INPUT] 3    0    [1    /1   ]  1.423104             1

nuclear repulsion = 19.05037959312
number of shells = 18
number of NR pGTOs = 122
number of NR cGTOs = 58
basis = ccecp-ccpvtz
ecp = ccecp
CPU time:         0.27


******** <class 'pyscf.df.df_jk.density_fit.<locals>.DFHF'> ********
method = DFHF-ROKS-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0.0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/abenali/Work/WorkShop/qmcpack_workshop_2021/qmc_workshop_2021/week4_molecules/03_qmc_ccECP/runs/O2/Dist_1/SCF/tmp_5xahyj8
max_memory 4000 MB (current use 108 MB)
num. doubly occ = 5  num. singly occ = 2
XC library pyscf.dft.libxc version 5.1.5
    S. Lehtola, C. Steigemann, M. J. Oliveira, and M. A. Marques, SoftwareX 7, 1 (2018)
XC functionals = SCAN
    J. Sun, A. Ruzsinszky, and J. P. Perdew, Phys. Rev. Lett. 115, 036402 (2015)
    J. Sun, A. Ruzsinszky, and J. P. Perdew, Phys. Rev. Lett. 115, 036402 (2015)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x7f8def217dd0>
grids dens level: 3
symmetrized grids: False
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x7f8def220290>
small_rho_cutoff = 1e-07
Set gradient conv threshold to 3.16228e-05
atom O rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50
  50  50  50  50  86  86  86  86  86  86  86  86  86 266 266 266 266 266
 266 266 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302 302
 302 302 302 266 266 266 266 266 266 266 266 266 266 266 266 266 266 266
 266 266 266]
tot grids = 28524
Drop grids 2434
    CPU time for setting up grids      0.03 sec, wall time      0.03 sec
nelec by numeric integration = [6.00000005 6.00000005]
    CPU time for vxc      0.37 sec, wall time      0.37 sec
Even tempered Gaussians are generated as DF auxbasis for  O
  ETB auxbasis for O  [[0, [64.177152, 1]], [0, [32.088576, 1]], [0, [16.044288, 1]], [0, [8.022144, 1]], [0, [4.011072, 1]], [0, [2.005536, 1]], [0, [1.002768, 1]], [0, [0.501384, 1]], [0, [0.250692, 1]], [1, [52.41108427692326, 1]], [1, [26.20554213846163, 1]], [1, [13.102771069230815, 1]], [1, [6.551385534615408, 1]], [1, [3.275692767307704, 1]], [1, [1.637846383653852, 1]], [1, [0.818923191826926, 1]], [1, [0.409461595913463, 1]], [1, [0.2047307979567315, 1]], [2, [42.802176, 1]], [2, [21.401088, 1]], [2, [10.700544, 1]], [2, [5.350272, 1]], [2, [2.675136, 1]], [2, [1.337568, 1]], [2, [0.668784, 1]], [2, [0.334392, 1]], [2, [0.167196, 1]], [3, [7.569571782318998, 1]], [3, [3.784785891159499, 1]], [3, [1.8923929455797495, 1]], [3, [0.9461964727898747, 1]], [3, [0.47309823639493737, 1]], [4, [5.35472, 1]], [4, [2.67736, 1]], [4, [1.33868, 1]]]
num shells = 70, num cGTOs = 286
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -88.7198678330827  Ecoul = 44.40596092335695  Exc = -6.824108988920215
init E= -32.087636305526
cond(S) = 1945.42362517122
    CPU time for initialize scf      0.49 sec, wall time      0.53 sec
  HOMO = -0.200417489393635  LUMO = 0.26481838754858
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.622681951336686 | -0.622681951336688 | -0.622681951336688
  Lowest 0-occ =    0.26481838754858 |  0.264818387548575 |  0.264818387548575
  1-occ =         -0.200417489393638 | -0.200417489393638 | -0.200417489393638
  1-occ =         -0.200417489393635 | -0.200417489393639 | -0.200417489393639
  Roothaan mo_energy =
[-1.54897604 -0.80179447 -0.64615281 -0.64615281 -0.62268195 -0.20041749
 -0.20041749  0.26481839  0.38333946  0.38333946  0.43260208  0.54511246
  0.54511246  0.64369879  0.69729775  1.09025404  1.1763275   1.17642884
  1.42932667  1.42932667  1.75052006  1.75073521  2.07429889  2.29797399
  2.29797399  2.34088521  2.74807705  2.74807705  3.25702484  3.25702484
  3.45580364  3.70799504  4.56971336  4.56977469  4.79986115  4.79986115
  4.86401022  4.86401022  5.37490676  5.37490676  5.50295631  6.03414186
  6.27020368  6.27031192  6.33633533  6.33633602  6.48511724  6.48511724
  6.53047678  6.53083252  6.94476964  6.94476964  7.78210235  8.14567678
  8.23299305  8.23299305 15.22289848 26.41654919]
nelec by numeric integration = [7.00000008 5.00000004]
    CPU time for vxc      0.27 sec, wall time      0.27 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -89.83910981727814  Ecoul = 46.18213928999644  Exc = -7.2121491633903805
cycle= 1 E= -31.8187400975521  delta_E= 0.269  |g|= 0.327  |ddm|=  2.4
    CPU time for cycle= 1      0.33 sec, wall time      0.33 sec
  HOMO = -0.0611778483342334  LUMO = 0.333975848443057
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.459210044501288 | -0.483290465475713 | -0.435129623526871
  Lowest 0-occ =   0.333975848443057 |  0.300289348468617 |  0.367662348417498
  1-occ =         -0.0611778483342346 | -0.126990498725209 | 0.000921353665572944
  1-occ =         -0.0611778483342334 | -0.126990498725209 | 0.000921353665573162
  Roothaan mo_energy =
[-1.39927108 -0.64701188 -0.51637859 -0.51637859 -0.45921004 -0.06117785
 -0.06117785  0.33397585  0.44096533  0.44096533  0.50088345  0.61145658
  0.61145658  0.79113614  0.80047483  1.15050499  1.24401583  1.24402226
  1.52323157  1.52323157  1.82369399  1.82384587  2.18805283  2.39511731
  2.39511731  2.47732292  2.88976144  2.88976144  3.38315821  3.38315821
  3.57834807  3.84655146  4.65866839  4.66007608  4.88791146  4.88791146
  4.97093884  4.97093884  5.46709456  5.46709456  5.65640299  6.14695289
  6.42353693  6.42444394  6.43865956  6.43958303  6.62619364  6.62619364
  6.67219833  6.67257679  7.07762101  7.07762101  7.94269068  8.27591948
  8.32563124  8.32563124 15.43677068 26.66365933]
nelec by numeric integration = [7.00000007 5.00000004]
    CPU time for vxc      0.28 sec, wall time      0.28 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -88.7063328677133  Ecoul = 44.79107915862555  Exc = -6.961698580675344
cycle= 2 E= -31.8265726966431  delta_E= -0.00783  |g|= 0.228  |ddm|= 0.606
    CPU time for cycle= 2      0.34 sec, wall time      0.34 sec
  HOMO = -0.121639128657045  LUMO = 0.312889796370661
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.522641659767884 | -0.592853719486937 | -0.546324154705609
  Lowest 0-occ =   0.312889796370661 |  0.266062261456289 |  0.328171887541997
  1-occ =         -0.121639128657046 |  -0.23037367202074 | -0.100104060531319
  1-occ =         -0.121639128657045 |  -0.23037367202074 | -0.100104060531319
  Roothaan mo_energy =
[-1.47095331 -0.70648741 -0.57511631 -0.57511631 -0.52264166 -0.12163913
 -0.12163913  0.3128898   0.41643231  0.41643231  0.47802869  0.58655954
  0.58655954  0.73259724  0.74957855  1.12801593  1.20761727  1.20762805
  1.48087369  1.48087369  1.78846698  1.78860879  2.14525592  2.35691966
  2.35691966  2.42020367  2.8276026   2.8276026   3.32651319  3.32651319
  3.51931436  3.79422675  4.60847977  4.60984809  4.84108902  4.84108902
  4.90900524  4.90900524  5.42047366  5.42047366  5.58129903  6.09200988
  6.35310178  6.35371669  6.38062182  6.38127093  6.56069115  6.56069115
  6.61000007  6.61015145  7.01099659  7.01099659  7.86304728  8.20735173
  8.26694864  8.26694864 15.34340572 26.55376276]
nelec by numeric integration = [7.00000008 5.00000004]
    CPU time for vxc      0.28 sec, wall time      0.28 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -89.30787176175203  Ecoul = 45.50487185857664  Exc = -7.083604400716376
cycle= 3 E= -31.8362247107718  delta_E= -0.00965  |g|= 0.0268  |ddm|= 0.288
    CPU time for cycle= 3      0.33 sec, wall time      0.33 sec
  HOMO = -0.117887501950915  LUMO = 0.313589112264394
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.521117270316936 |  -0.53975879927063 | -0.492711823669379
  Lowest 0-occ =   0.313589112264394 |  0.283673058102766 |   0.34699791128351
  1-occ =         -0.117887501950917 |  -0.17758625021556 | -0.0461779023233962
  1-occ =         -0.117887501950915 | -0.177586250215559 | -0.0461779023233959
  Roothaan mo_energy =
[-1.46247759 -0.70517875 -0.57014763 -0.57014763 -0.52111727 -0.1178875
 -0.1178875   0.31358911  0.41890272  0.41890272  0.47883931  0.58817648
  0.58817648  0.73654366  0.75174457  1.12985573  1.21132954  1.21135336
  1.48363006  1.48363006  1.79089509  1.79110216  2.14689455  2.35871946
  2.35871946  2.42341814  2.83169609  2.83169609  3.33028589  3.33028589
  3.52361762  3.79615874  4.61290271  4.61425097  4.84517056  4.84517056
  4.91504697  4.91504697  5.42411886  5.42411886  5.58612266  6.09451917
  6.35737504  6.35803531  6.38561621  6.38628843  6.56311967  6.56311967
  6.61250895  6.61270954  7.0136988   7.0136988   7.86835554  8.21072558
  8.27132855  8.27132855 15.34796681 26.55847496]
nelec by numeric integration = [7.00000008 5.00000004]
    CPU time for vxc      0.27 sec, wall time      0.27 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -89.26951083125878  Ecoul = 45.460406598362795  Exc = -7.077617664135136
cycle= 4 E= -31.8363423039111  delta_E= -0.000118  |g|= 0.00544  |ddm|= 0.014
    CPU time for cycle= 4      0.33 sec, wall time      0.33 sec
  HOMO = -0.116095602386872  LUMO = 0.314095398242621
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.519708950687475 | -0.542116995383424 | -0.495082555021186
  Lowest 0-occ =   0.314095398242621 |   0.28291900454168 |   0.34603007588189
  1-occ =         -0.116095602386875 | -0.180625862209822 | -0.0492770815693382
  1-occ =         -0.116095602386872 | -0.180625862209822 | -0.0492770815693383
  Roothaan mo_energy =
[-1.46042675 -0.70375305 -0.56849949 -0.56849949 -0.51970895 -0.1160956
 -0.1160956   0.3140954   0.41973666  0.41973666  0.47931751  0.58889281
  0.58889281  0.73820039  0.75278399  1.1306934   1.21243403  1.21248179
  1.48483686  1.48483686  1.79195105  1.79219427  2.14802331  2.35987412
  2.35987412  2.42481068  2.83334886  2.83334886  3.33182961  3.33182961
  3.5250743   3.79762851  4.61434029  4.61568288  4.84657484  4.84657484
  4.91674545  4.91674545  5.42555058  5.42555058  5.58771643  6.09599718
  6.35918098  6.35985873  6.38725199  6.38793032  6.5647959   6.5647959
  6.61411443  6.61434435  7.01531413  7.01531413  7.87010939  8.21238857
  8.27295653  8.27295653 15.35012257 26.5607767 ]
nelec by numeric integration = [7.00000008 5.00000004]
    CPU time for vxc      0.27 sec, wall time      0.27 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -89.25629642208472  Ecoul = 45.44454615630466  Exc = -7.074977193379936
cycle= 5 E= -31.83634786604  delta_E= -5.56e-06  |g|= 5.49e-05  |ddm|= 0.00562
    CPU time for cycle= 5      0.33 sec, wall time      0.33 sec
  HOMO = -0.116109169257544  LUMO = 0.314073762068175
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.519730571849109 | -0.543242866733107 | -0.496225739435305
  Lowest 0-occ =   0.314073762068175 |   0.28255682776239 |  0.345587289533868
  1-occ =         -0.116109169257548 | -0.181792019535203 | -0.0504347379445517
  1-occ =         -0.116109169257544 | -0.181792019535203 | -0.0504347379445517
  Roothaan mo_energy =
[-1.46044285 -0.70377521 -0.56852348 -0.56852348 -0.51973057 -0.11610917
 -0.11610917  0.31407376  0.41971632  0.41971632  0.47928764  0.58886966
  0.58886966  0.73817848  0.75275942  1.13069465  1.21241034  1.21245874
  1.48481669  1.48481669  1.79193378  1.7921771   2.14800748  2.35986173
  2.35986173  2.42479281  2.83332578  2.83332578  3.3318083   3.3318083
  3.52504558  3.79761082  4.61432208  4.6156632   4.84655594  4.84655594
  4.91672979  4.91672979  5.42553662  5.42553662  5.58768544  6.09598493
  6.35915456  6.35983335  6.38723316  6.38791256  6.56477431  6.56477431
  6.61409461  6.61432587  7.01528627  7.01528627  7.87007693  8.2123705
  8.27294063  8.27294063 15.35009465 26.56074426]
nelec by numeric integration = [7.00000008 5.00000004]
    CPU time for vxc      0.27 sec, wall time      0.27 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -89.25643048636466  Ecoul = 45.44470726841537  Exc = -7.075004242580661
cycle= 6 E= -31.83634786741  delta_E= -1.37e-09  |g|= 1.85e-05  |ddm|= 0.00018
    CPU time for cycle= 6      0.33 sec, wall time      0.33 sec
  HOMO = -0.116104687602946  LUMO = 0.314073827816436
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.519726813216231 |  -0.54323156809137 | -0.496214624852992
  Lowest 0-occ =   0.314073827816436 |  0.282561631174068 |  0.345588635554558
  1-occ =         -0.116104687602949 | -0.181780723592018 | -0.0504211430104832
  1-occ =         -0.116104687602946 | -0.181780723592017 | -0.0504211430104825
  Roothaan mo_energy =
[-1.46043792 -0.70377174 -0.56851979 -0.56851979 -0.51972681 -0.11610469
 -0.11610469  0.31407383  0.41971722  0.41971722  0.47928748  0.5888702
  0.5888702   0.73818284  0.75276177  1.13069642  1.21241229  1.21246063
  1.48481858  1.48481858  1.79193608  1.79217922  2.14800915  2.35986343
  2.35986343  2.42479617  2.8333295   2.8333295   3.33181209  3.33181209
  3.52504895  3.7976134   4.61432515  4.6156661   4.84655889  4.84655889
  4.91673393  4.91673393  5.4255399   5.4255399   5.5876901   6.09598872
  6.35915919  6.35983823  6.38723698  6.38791651  6.56477784  6.56477784
  6.61409883  6.61433018  7.01528975  7.01528975  7.87008223  8.21237434
  8.27294414  8.27294414 15.35010131 26.56075264]
nelec by numeric integration = [7.00000008 5.00000004]
    CPU time for vxc      0.28 sec, wall time      0.28 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -89.25639037786662  Ecoul = 45.4446590164035  Exc = -7.0749960991238945
cycle= 7 E= -31.836347867467  delta_E= -5.71e-11  |g|= 2.73e-07  |ddm|= 1.91e-05
    CPU time for cycle= 7      0.34 sec, wall time      0.34 sec
  HOMO = -0.116104479587631  LUMO = 0.314073927439549
                  Roothaan           | alpha              | beta
  Highest 2-occ = -0.519726612210465 | -0.543235059713781 | -0.496218164707143
  Lowest 0-occ =   0.314073927439549 |  0.282560547579099 |  0.345587307300013
  1-occ =         -0.116104479587631 |  -0.18178428774493 | -0.0504246738666293
  1-occ =         -0.116104479587631 |  -0.18178428774493 | -0.0504246738666284
  Roothaan mo_energy =
[-1.46043767 -0.70377155 -0.56851959 -0.56851959 -0.51972661 -0.11610448
 -0.11610448  0.31407393  0.41971734  0.41971734  0.47928757  0.58887031
  0.58887031  0.73818307  0.75276193  1.13069656  1.21241244  1.21246078
  1.48481873  1.48481873  1.79193624  1.79217938  2.1480093   2.35986356
  2.35986356  2.42479635  2.83332967  2.83332967  3.3318123   3.3318123
  3.52504914  3.79761357  4.61432534  4.6156663   4.84655908  4.84655908
  4.91673414  4.91673414  5.42554009  5.42554009  5.58769031  6.09598892
  6.3591594   6.35983844  6.38723718  6.38791671  6.56477802  6.56477802
  6.61409904  6.61433039  7.01528994  7.01528994  7.87008247  8.21237457
  8.27294433  8.27294433 15.35010152 26.56075284]
nelec by numeric integration = [7.00000008 5.00000004]
    CPU time for vxc      0.28 sec, wall time      0.28 sec
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -89.25638927016605  Ecoul = 45.44465768835182  Exc = -7.074995878772866
Extra cycle  E= -31.8363478674671  delta_E= -8.53e-14  |g|= 2.09e-07  |ddm|= 4.73e-07
    CPU time for scf_cycle      3.15 sec, wall time      3.19 sec
    CPU time for SCF      3.15 sec, wall time      3.19 sec
converged SCF energy = -31.8363478674671
Using Python 3.x
Wavefunction successfully saved to QMCPACK HDF5 Format
Use: "convert4qmc -pyscf  scf.h5" to generate QMCPACK input files
