#INFO: **** input file is /home/abenali/Work/WorkShop/qmcpack_workshop_2021/qmc_workshop_2021/week4_molecules/Be2/00_dft/runs/Be2/cc-pvtz/PBE/SCF/scf.py ****

#! /usr/bin/env python3

import numpy as np
from numpy import array

### generated pyscfimport text ###
from pyscf import df, scf, dft
### end generated pyscfimport text ###





### generated system text ###
from pyscf import gto as gto_loc
mol = gto_loc.Mole()
mol.verbose  = 5
mol.atom     = '''
               Be   0.00000000   0.00000000   0.00000000
               Be   2.45360300   0.00000000   0.00000000
               '''
mol.basis    = 'cc-pvtz'
mol.unit     = 'A'
mol.charge   = 0
mol.spin     = 0
mol.symmetry = True
mol.build()
### end generated system text ###




### generated calculation text ###
mf = scf.ROKS(mol).density_fit()
mf.max_cycle=200
mf.level_shift=0.0
mf.xc          = 'PBE'
mf.tol         = '1e-10'
e_scf = mf.kernel()
### end generated calculation text ###



### generated conversion text ###
from PyscfToQmcpack import savetoqmcpack
savetoqmcpack(mol,mf,'scf')
### end generated conversion text ###

#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='abenali', release='5.11.0-38-generic', version='#42~20.04.1-Ubuntu SMP Tue Sep 28 20:41:07 UTC 2021', machine='x86_64', processor='x86_64')  Threads 1
Python 3.7.11 (default, Sep  9 2021, 02:06:38) 
[GCC 9.3.0]
numpy 1.20.3  scipy 1.6.2
Date: Wed Oct 20 12:23:30 2021
PySCF version 2.0.0a
PySCF path  /home/abenali/Work/src/pyscf
GIT HEAD (branch master) 3e8ba375fd4229f000289589fd02193633380853

[CONFIG] conf_file None
[INPUT] verbose = 5
[INPUT] max_memory = 4000 
[INPUT] num. atoms = 2
[INPUT] num. electrons = 8
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry True subgroup None
[INPUT] Mole.unit = A
[INPUT]  1 Be     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 Be     2.453603000000   0.000000000000   0.000000000000 AA    4.636637688411   0.000000000000   0.000000000000 Bohr
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] Be
[INPUT] 0    0    [9    /2   ]  6863              0.000236 -4.3e-05
                                1030              0.001826 -0.000333
                                234.7             0.009452 -0.001736
                                66.56             0.037957 -0.007012
                                21.69             0.119965 -0.023126
                                7.734             0.282162 -0.058138
                                2.916             0.427404 -0.114556
                                1.13              0.266278 -0.135908
                                0.1101            -0.007275 0.577441
[INPUT] 0    0    [1    /1   ]  0.2577               1
[INPUT] 0    0    [1    /1   ]  0.04409              1
[INPUT] 1    0    [3    /1   ]  7.436             0.010736
                                1.577             0.062854
                                0.4352            0.24818
[INPUT] 1    0    [1    /1   ]  0.1438               1
[INPUT] 1    0    [1    /1   ]  0.04994              1
[INPUT] 2    0    [1    /1   ]  0.348                1
[INPUT] 2    0    [1    /1   ]  0.1803               1
[INPUT] 3    0    [1    /1   ]  0.325                1

nuclear repulsion = 3.45077641929848
point group symmetry = Dooh
num. orbitals of irrep A1g = 10
num. orbitals of irrep E1gx = 6
num. orbitals of irrep E1gy = 6
num. orbitals of irrep A1u = 10
num. orbitals of irrep E1uy = 6
num. orbitals of irrep E1ux = 6
num. orbitals of irrep E2gx = 3
num. orbitals of irrep E2gy = 3
num. orbitals of irrep E3gx = 1
num. orbitals of irrep E3gy = 1
num. orbitals of irrep E2uy = 3
num. orbitals of irrep E2ux = 3
num. orbitals of irrep E3uy = 1
num. orbitals of irrep E3ux = 1
number of shells = 18
number of NR pGTOs = 86
number of NR cGTOs = 60
basis = cc-pvtz
ecp = {}
CPU time:         0.64


******** <class 'pyscf.df.df_jk.density_fit.<locals>.DFHF'> ********
method = DFHF-SymAdaptedROKS-SymAdaptedROHF-ROHF-RHF
initial guess = minao
damping factor = 0
level_shift factor = 0.0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 200
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /home/abenali/Work/WorkShop/qmcpack_workshop_2021/qmc_workshop_2021/week4_molecules/Be2/00_dft/runs/Be2/cc-pvtz/PBE/SCF/tmpbjwk22hf
max_memory 4000 MB (current use 112 MB)
num. doubly occ = 4  num. singly occ = 0
XC library pyscf.dft.libxc version 5.1.5
    S. Lehtola, C. Steigemann, M. J. Oliveira, and M. A. Marques, SoftwareX 7, 1 (2018)
XC functionals = PBE
    J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)
    J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 77, 3865 (1996)
    J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev. Lett. 78, 1396 (1997)
radial grids: 
    Treutler-Ahlrichs [JCP 102, 346 (1995); DOI:10.1063/1.469408] (M4) radial grids
    
becke partition: Becke, JCP 88, 2547 (1988); DOI:10.1063/1.454033
pruning grids: <function nwchem_prune at 0x7fa63c1aad40>
grids dens level: 3
symmetrized grids: True
atomic radii adjust function: <function treutler_atomic_radii_adjust at 0x7fa63c1b3200>
small_rho_cutoff = 1e-07
Freeze 0 electrons in irreps []
    8 free electrons in irreps A1g E1gx E1gy A1u E1uy E1ux E2gx E2gy E3gx E3gy E2uy E2ux E3uy E3ux
Set gradient conv threshold to 3.16228e-05
atom Be rad-grids = 75, ang-grids = [ 50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50  50
  50  50  50  50  50  50  50  50  86  86  86  86  86  86  86  86  86  86
  86 266 266 266 266 266 266 266 266 302 302 302 302 302 302 302 302 302
 302 302 302 302 302 302 302 302 302 302 302 302 266 266 266 266 266 266
 266 266 266]
tot grids = 26220
Drop grids 790
    CPU time for setting up grids      0.06 sec, wall time      0.06 sec
nelec by numeric integration = [3.99998754 3.99998754]
    CPU time for vxc      0.28 sec, wall time      0.29 sec
Even tempered Gaussians are generated as DF auxbasis for  Be
  ETB auxbasis for Be  [[0, [1444.74112, 1]], [0, [722.37056, 1]], [0, [361.18528, 1]], [0, [180.59264, 1]], [0, [90.29632, 1]], [0, [45.14816, 1]], [0, [22.57408, 1]], [0, [11.28704, 1]], [0, [5.64352, 1]], [0, [2.82176, 1]], [0, [1.41088, 1]], [0, [0.70544, 1]], [0, [0.35272, 1]], [0, [0.17636, 1]], [0, [0.08818, 1]], [1, [96.10019540145795, 1]], [1, [48.050097700728976, 1]], [1, [24.025048850364488, 1]], [1, [12.012524425182244, 1]], [1, [6.006262212591122, 1]], [1, [3.003131106295561, 1]], [1, [1.5015655531477805, 1]], [1, [0.7507827765738903, 1]], [1, [0.3753913882869451, 1]], [1, [0.18769569414347256, 1]], [1, [0.09384784707173628, 1]], [2, [12.78464, 1]], [2, [6.39232, 1]], [2, [3.19616, 1]], [2, [1.59808, 1]], [2, [0.79904, 1]], [2, [0.39952, 1]], [2, [0.19976, 1]], [2, [0.09988, 1]]]
num shells = 68, num cGTOs = 176
    CPU time for df-vj      0.05 sec, wall time      0.05 sec
E1 = -45.155223272960676  Ecoul = 17.907069216969116  Exc = -5.513018978715939
init E= -29.310396615409
cond(S) = 1114.8843271075195
    CPU time for initialize scf      0.41 sec, wall time      0.43 sec
HOMO (A1u) = -0.163761626591418  LUMO (E1uy) = -0.103222050903239
double occ irrep_nelec = [2, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
single occ irrep_nelec = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
  Roothaan mo_energy =
[-3.87500276 -0.26350576 -0.10045576  0.09059875  0.10744358  0.45084418
  0.77997394  0.9933725   1.21955183  1.56477261 -0.03217611  0.14165802
  0.50057909  0.78887885  1.25165314  1.62209657 -0.03217611  0.14165802
  0.50057909  0.78887885  1.25165314  1.62209657 -3.87498916 -0.16376163
  0.05841951  0.12412619  0.1960288   0.57535491  0.78272288  1.20242686
  1.42967183  4.25778456 -0.10322205  0.10981723  0.2838955   0.73448093
  0.96365981  1.2420363  -0.10322205  0.10981723  0.2838955   0.73448093
  0.96365981  1.2420363   0.26857314  0.97229548  1.13275655  0.26857325
  0.97229555  1.1327556   1.11140365  1.11140365  0.36410728  1.16049149
  1.2847224   0.36410721  1.16049187  1.28472304  1.04695928  1.04695928]
nelec by numeric integration = [4.00000016 4.00000016]
    CPU time for vxc      0.23 sec, wall time      0.23 sec
    CPU time for df-vj      0.03 sec, wall time      0.03 sec
E1 = -45.05939412748392  Ecoul = 17.80974753728156  Exc = -5.474107749843731
cycle= 1 E= -29.2729779207476  delta_E= 0.0374  |g|= 0.0214  |ddm|= 0.556
    CPU time for cycle= 1      0.27 sec, wall time      0.27 sec
HOMO (A1u) = -0.166938320238428  LUMO (E1uy) = -0.104719626220179
double occ irrep_nelec = [2, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
single occ irrep_nelec = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
  Roothaan mo_energy =
[-3.89506403 -0.26307885 -0.10264034  0.08805927  0.10517034  0.44939981
  0.77630054  0.99291517  1.2141926   1.56406371 -0.03516434  0.13847066
  0.49783192  0.78429817  1.2508871   1.62172306 -0.03516434  0.13847066
  0.49783192  0.78429817  1.2508871   1.62172306 -3.89506643 -0.16693832
  0.05634917  0.12120349  0.19475293  0.57371977  0.7759112   1.20176187
  1.43006665  4.24942781 -0.10471963  0.10764224  0.28121335  0.72922526
  0.96370247  1.2408873  -0.10471963  0.10764224  0.28121335  0.72922526
  0.96370247  1.2408873   0.26689803  0.97057706  1.13188661  0.26689812
  0.97057706  1.13188576  1.11012226  1.11012226  0.36142698  1.16037445
  1.2829667   0.36142691  1.16037489  1.28296728  1.04577005  1.04577005]
nelec by numeric integration = [4.00000016 4.00000016]
    CPU time for vxc      0.19 sec, wall time      0.19 sec
    CPU time for df-vj      0.03 sec, wall time      0.03 sec
E1 = -45.041879210942696  Ecoul = 17.794204887381007  Exc = -5.476127632156183
cycle= 2 E= -29.2730255364194  delta_E= -4.76e-05  |g|= 0.00753  |ddm|= 0.0341
    CPU time for cycle= 2      0.24 sec, wall time      0.24 sec
HOMO (A1u) = -0.167426064595818  LUMO (E1ux) = -0.106058186739599
double occ irrep_nelec = [2, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
single occ irrep_nelec = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
  Roothaan mo_energy =
[-3.89586991 -0.26536554 -0.1035025   0.08750108  0.10445028  0.44875575
  0.77487857  0.99114669  1.21313208  1.56273201 -0.03600377  0.13784382
  0.49722958  0.78306274  1.24943907  1.62064149 -0.03600377  0.13784382
  0.49722958  0.78306274  1.24943907  1.62064149 -3.89587012 -0.16742606
  0.05573349  0.12086148  0.19360719  0.57265786  0.77550406  1.20091698
  1.42821593  4.24782653 -0.10605819  0.10678939  0.28010483  0.72799355
  0.96152927  1.24006219 -0.10605819  0.10678939  0.28010483  0.72799355
  0.96152927  1.24006219  0.26570251  0.96916257  1.13054039  0.26570259
  0.96916257  1.13053953  1.10894466  1.10894466  0.3605813   1.15879142
  1.28203984  0.36058123  1.15879186  1.28204043  1.0445204   1.0445204 ]
nelec by numeric integration = [4.00000016 4.00000016]
    CPU time for vxc      0.18 sec, wall time      0.18 sec
    CPU time for df-vj      0.04 sec, wall time      0.04 sec
E1 = -45.054833359270134  Ecoul = 17.808386439250867  Exc = -5.47739915001473
cycle= 3 E= -29.2730696507355  delta_E= -4.41e-05  |g|= 0.00122  |ddm|= 0.0115
    CPU time for cycle= 3      0.23 sec, wall time      0.23 sec
HOMO (A1u) = -0.167332465341486  LUMO (E1uy) = -0.105902814937229
double occ irrep_nelec = [2, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
single occ irrep_nelec = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
  Roothaan mo_energy =
[-3.89461585 -0.26511236 -0.10339455  0.08756381  0.10449419  0.44888224
  0.77513142  0.99137052  1.21346109  1.56297105 -0.03591115  0.13790321
  0.49731334  0.78334692  1.24958344  1.62079268 -0.03591115  0.13790321
  0.49731334  0.78334692  1.24958344  1.62079268 -3.89461536 -0.16733247
  0.05582653  0.12091636  0.19375683  0.57283709  0.77569928  1.20112175
  1.42842244  4.24847648 -0.10590281  0.10686614  0.28019665  0.72827125
  0.96170959  1.24017497 -0.10590281  0.10686614  0.28019665  0.72827125
  0.96170959  1.24017497  0.26582631  0.96927437  1.13068385  0.26582639
  0.96927437  1.13068298  1.10907038  1.10907038  0.36065454  1.15899238
  1.28210713  0.36065448  1.15899283  1.28210772  1.04465419  1.04465419]
nelec by numeric integration = [4.00000016 4.00000016]
    CPU time for vxc      0.12 sec, wall time      0.12 sec
    CPU time for df-vj      0.02 sec, wall time      0.02 sec
E1 = -45.05281094526829  Ecoul = 17.80584342739855  Exc = -5.476878991961307
cycle= 4 E= -29.2730700905326  delta_E= -4.4e-07  |g|= 0.000222  |ddm|= 0.00164
    CPU time for cycle= 4      0.15 sec, wall time      0.15 sec
HOMO (A1u) = -0.167381494866792  LUMO (E1ux) = -0.105949574218284
double occ irrep_nelec = [2, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
single occ irrep_nelec = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
  Roothaan mo_energy =
[-3.89486916 -0.26517543 -0.10344505  0.08753374  0.10446582  0.44885021
  0.77505229  0.99130802  1.21337757  1.56290911 -0.03595732  0.13787334
  0.49727541  0.78326947  1.24952947  1.62074803 -0.03595732  0.13787334
  0.49727541  0.78326947  1.24952947  1.62074803 -3.89486878 -0.16738149
  0.05579574  0.1208889   0.19371604  0.57278973  0.77562362  1.2010767
  1.4283625   4.24833291 -0.10594957  0.1068369   0.28014946  0.72818944
  0.96165137  1.24012904 -0.10594957  0.1068369   0.28014946  0.72818944
  0.96165137  1.24012904  0.26578593  0.96922172  1.13063516  0.265786
  0.96922173  1.13063428  1.10902455  1.10902455  0.36061408  1.15894708
  1.28205713  0.36061401  1.15894753  1.28205771  1.04460814  1.04460814]
nelec by numeric integration = [4.00000016 4.00000016]
    CPU time for vxc      0.12 sec, wall time      0.12 sec
    CPU time for df-vj      0.02 sec, wall time      0.02 sec
E1 = -45.05317731841431  Ecoul = 17.80630765626471  Exc = -5.4769768607119005
cycle= 5 E= -29.273070103563  delta_E= -1.3e-08  |g|= 1.27e-05  |ddm|= 0.000276
    CPU time for cycle= 5      0.15 sec, wall time      0.15 sec
HOMO (A1u) = -0.167372346405327  LUMO (E1ux) = -0.10594225206893
double occ irrep_nelec = [2, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
single occ irrep_nelec = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
  Roothaan mo_energy =
[-3.89484838 -0.2651673  -0.10343587  0.08753932  0.10447072  0.44885768
  0.77506351  0.99131755  1.21338786  1.56291921 -0.03594948  0.1378791
  0.497283    0.78328045  1.24953854  1.62075652 -0.03594948  0.1378791
  0.497283    0.78328045  1.24953854  1.62075652 -3.894848   -0.16737235
  0.05580212  0.12089523  0.19372283  0.57279796  0.77563568  1.20108589
  1.42837182  4.2483465  -0.10594225  0.1068419   0.28015703  0.72820088
  0.96165909  1.24013819 -0.10594225  0.1068419   0.28015703  0.72820088
  0.96165909  1.24013819  0.26579236  0.96922965  1.13064342  0.26579243
  0.96922965  1.13064254  1.10903213  1.10903213  0.36062085  1.15895525
  1.28206534  0.36062078  1.1589557   1.28206593  1.04461566  1.04461566]
nelec by numeric integration = [4.00000016 4.00000016]
    CPU time for vxc      0.12 sec, wall time      0.12 sec
    CPU time for df-vj      0.02 sec, wall time      0.02 sec
E1 = -45.05315180331021  Ecoul = 17.806275377870023  Exc = -5.476970097517972
cycle= 6 E= -29.2730701036597  delta_E= -9.66e-11  |g|= 5.45e-07  |ddm|= 4.1e-05
    CPU time for cycle= 6      0.15 sec, wall time      0.15 sec
HOMO (A1u) = -0.167372632376544  LUMO (E1ux) = -0.105942618489019
double occ irrep_nelec = [2, 0, 0, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
single occ irrep_nelec = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
  Roothaan mo_energy =
[-3.894849   -0.26516781 -0.10343619  0.08753911  0.10447053  0.4488574
  0.77506306  0.99131709  1.21338746  1.56291876 -0.03594978  0.13787892
  0.49728273  0.78327997  1.24953814  1.62075615 -0.03594978  0.13787892
  0.49728273  0.78327997  1.24953814  1.62075615 -3.89484863 -0.16737263
  0.05580192  0.12089505  0.19372253  0.57279759  0.77563535  1.20108552
  1.42837134  4.24834596 -0.10594262  0.10684169  0.28015671  0.72820042
  0.96165861  1.24013786 -0.10594262  0.10684169  0.28015671  0.72820042
  0.96165861  1.24013786  0.26579201  0.96922929  1.13064305  0.26579208
  0.96922929  1.13064217  1.10903175  1.10903175  0.36062053  1.15895485
  1.28206501  0.36062046  1.1589553   1.2820656   1.04461527  1.04461527]
nelec by numeric integration = [4.00000016 4.00000016]
    CPU time for vxc      0.09 sec, wall time      0.09 sec
    CPU time for df-vj      0.02 sec, wall time      0.02 sec
E1 = -45.053154230858446  Ecoul = 17.806278142684178  Exc = -5.4769704347839685
Extra cycle  E= -29.2730701036598  delta_E= -8.53e-14  |g|= 4.97e-07  |ddm|= 1.59e-06
    CPU time for scf_cycle      1.71 sec, wall time      1.73 sec
    CPU time for SCF      1.71 sec, wall time      1.73 sec
converged SCF energy = -29.2730701036598
Using Python 3.x
Wavefunction successfully saved to QMCPACK HDF5 Format
Use: "convert4qmc -pyscf  scf.h5" to generate QMCPACK input files
